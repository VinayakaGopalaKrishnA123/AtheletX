<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login/Signup</title>
    <link rel="stylesheet" type="text/css" href="Login.css">
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <h2 class="header">Krida<span>Verse</span></h2>

    <div class="main">
        <!-- Checkbox to toggle between Login and Signup -->
        <input type="checkbox" id="chk" aria-hidden="true">

        <!-- Signup Form -->
        <div class="signup">
            <form>
                <label for="chk" aria-hidden="true">Sign up</label>
                               <input type="text" id="username" placeholder="User name" required="">
                <input type="email" id="email" placeholder="Email" required="">
                <input type="password" id="password" placeholder="Password" required="">
                <button type="button" onclick="handleFormSubmit('signup')">Sign up</button>
            </form>
        </div>

        <!-- Login Form -->
        <div class="login">
            <form>
                <label for="chk" aria-hidden="true">Login</label>
                <input type="text" id="login-username" placeholder="User name" required="">
                <input type="password" id="login-password" placeholder="Password" required="">
                <button type="button" onclick="handleFormSubmit('login')">Login</button>
            </form>
        </div>
    </div>

    <script>
        // Function to handle form submission (login or signup)
        function handleFormSubmit(mode) {
            let username, password, email;

            if (mode === 'login') {
                username = document.getElementById('login-username').value.trim();
                password = document.getElementById('login-password').value.trim();
            } else {
                username = document.getElementById('username').value.trim();
                password = document.getElementById('password').value.trim();
                email = document.getElementById('email').value.trim();
            }

            if (!username || !password || (mode === 'signup' && !email)) {
                alert('Please fill in all fields.');
                return;
            }

            if (mode === 'login') {
                const result = loginUser(username, password);
                if (result.success) {
                    alert("Login successful!");
                   window.location.href = "../home/index.html";// Redirect to your dashboard
                } else {
                    alert(result.message);
                }
            } else {
                const result = registerUser(username, password, email);
                alert(result.message);
                if (result.success) {
                    document.querySelector('input[type="checkbox"]').checked = false; // Switch to login after successful signup
                }
            }
        }

        // Function for registering a new user
      function registerUser(username, password, email) {
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    const exists = users.some(user => user.username === username);
    
    if (exists) return { success: false, message: "Username already exists." };

    // Add the new user to the local storage
    users.push({ username, password, email });
    localStorage.setItem("users", JSON.stringify(users));
    
    // Redirect to the dashboard page after successful registration
    window.location.href = "../home/index.html";

    return { success: true, message: "Registration successful!" };  // This won't execute because of the redirect
}


        // Function for logging in a user
        function loginUser(username, password) {
            let users = JSON.parse(localStorage.getItem("users") || "[]");
            const user = users.find(user => user.username === username && user.password === password);
            if (user) {
                setLoggedInUser(username);
                return { success: true };
            }
            return { success: false, message: "Invalid username or password." };
        }

        // Function to save the logged-in user in localStorage
        function setLoggedInUser(username) {
            localStorage.setItem("loggedInUser", username);
        }

        // Optional: Preload some sample users when the page loads
        window.onload = () => {
            if (!localStorage.getItem("users")) {
                const sampleUsers = [
                    { username: "john_doe", password: "helloWorld", email: "john@example.com" },
                    { username: "varun123", password: "pass123", email: "varun@example.com" },
                ];
                localStorage.setItem("users", JSON.stringify(sampleUsers));
            }
        };
    </script>
</body>
</html>
